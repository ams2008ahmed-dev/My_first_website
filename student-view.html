<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ÙˆØ§Ù„Ø£ÙÙƒØ§Ø± - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ÙˆØ§Ù„Ø£ÙÙƒØ§Ø±</h1>
      <a href="index.html" class="back-link">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </div>

    <div class="filter-tabs">
      <button class="tab-btn active" data-filter="all">Ø§Ù„ÙƒÙ„</button>
      <button class="tab-btn" data-filter="problem">Ø§Ù„Ù…Ø´Ø§ÙƒÙ„</button>
      <button class="tab-btn" data-filter="idea">Ø§Ù„Ø£ÙÙƒØ§Ø±</button>
    </div>

    <div id="reportsContainer" class="reports-grid">
      <div class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    </div>
  </div>

  <script>
    let allReports = [];
    let currentFilter = 'all';

    function loadReports() {
      allReports = JSON.parse(localStorage.getItem('reports')) || [];
      displayReports();
    }

    function displayReports() {
      const container = document.getElementById('reportsContainer');
      const filteredReports = currentFilter === 'all' 
        ? allReports 
        : allReports.filter(r => r.type === currentFilter);

      if (filteredReports.length === 0) {
        container.innerHTML = '<div class="empty-state">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ù„Ø§ØºØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
        return;
      }

      container.innerHTML = filteredReports.map(report => `
        <div class="report-card ${report.type}">
          <div class="report-header">
            <span class="report-type">${report.type === 'problem' ? 'ğŸ”§ Ù…Ø´ÙƒÙ„Ø©' : 'ğŸ’¡ ÙÙƒØ±Ø©'}</span>
            ${report.is_resolved ? '<span class="resolved-badge">âœ“ ØªÙ… Ø§Ù„Ø­Ù„</span>' : ''}
          </div>
          <div class="report-info">
            <p><strong>Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> ${report.student_name}</p>
            <p><strong>Ø§Ù„ØµÙ:</strong> ${report.grade} - ${report.section}</p>
          </div>
          <div class="report-description">
            <p>${report.description}</p>
          </div>
          ${report.solution_idea ? `
            <div class="solution-idea">
              <strong>Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ø­Ù„:</strong>
              <p>${report.solution_idea}</p>
            </div>
          ` : ''}
          ${report.image_url ? `
            <div class="report-image">
              <img src="${report.image_url}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¨Ù„Ø§Øº">
            </div>
          ` : ''}
          <div class="report-footer">
            <small>${new Date(report.created_at).toLocaleString('ar-SA')}</small>
          </div>
        </div>
      `).join('');
    }

    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        currentFilter = this.getAttribute('data-filter');
        displayReports();
      });
    });

    loadReports();
    setInterval(loadReports, 5000);
  </script>
</body>
</html>
